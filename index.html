<!doctype html>
<html lang=en>
<head>
<meta charset=UTF-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<title>HPYM BUS BOARDING PASS</title>
<link href="https://fonts.googleapis.com/css?family=Bebas Neue" rel=stylesheet>
<style>body{font-family:'Bebas Neue';font-weight:100;text-align:center;margin:20px}</style>
</head>
<body>
<h1>HPYM BUS BOARDING PASS</h1>
<form id=imageForm>
<label for=excelInput style=font-size:30px>Upload Excel/CSV:</label>
<input type=file id=excelInput accept=".xlsx, .csv" required>
<button style=width:150px;height:50px type=button onclick=generateImages()>Generate Images</button>
</form>
<div id=result></div>
<script src=https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.4/xlsx.full.min.js></script>
<script>function generateImages(){const e=document.getElementById("excelInput"),t=(document.getElementById("result"),e.files[0]);if(!t)return void alert("Please upload an Excel/CSV file.");const a=new FileReader;a.onload=function(e){const t=XLSX.read(e.target.result,{type:"binary"});generateImagesWithData(XLSX.utils.sheet_to_json(t.Sheets[t.SheetNames[0]]))},a.readAsBinaryString(t)}function generateImagesWithData(e){const t=new Image;t.src="bus.jpg";new Promise((e=>{t.onload=e})).then((()=>{e.forEach((e=>{const a=e.x||900,n=e.y||470,o=document.createElement("canvas"),s=o.getContext("2d");o.width=t.width,o.height=t.height,s.drawImage(t,0,0,o.width,o.height),s.font='60px "Bebas Neue"',s.fillStyle="#950c0a",s.fillText(e.Name,a,n),s.font='140px "Bebas Neue"',s.fillText(`${e["Bus No"]}`,a+915,n-110),s.font='60px "Bebas Neue"',s.fillText(`${e["Bus Captain"]} - ${e.Contact}`,a,n+95);const i=o.toDataURL("image/jpeg"),l=document.createElement("a");l.href=i,l.download=`Bus No ${e["Bus No"]} - ${e.Name} Boarding Pass.jpeg`,l.click()}))}))}</script>
</body>
</html>
